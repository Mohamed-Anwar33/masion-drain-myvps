# إعدادات الإيميل المحمية - Maison Darin

## نظرة عامة
تم تأمين إعدادات SMTP لموقع ميزون دارين عبر تثبيتها في الكود بدلاً من قاعدة البيانات لضمان أقصى درجات الأمان.

## الإعدادات الثابتة

### معلومات SMTP المحمية:
- **الخادم**: smtp.gmail.com
- **المنفذ**: 587
- **المستخدم**: maisondarin2025@gmail.com
- **كلمة المرور**: محمية في متغير البيئة `EMAIL_APP_PASSWORD`

## إعداد كلمة مرور التطبيق

### خطوات الحصول على App Password من Gmail:

1. **تسجيل الدخول إلى Gmail**
   - اذهب إلى [myaccount.google.com](https://myaccount.google.com)
   - سجل دخول بحساب maisondarin2025@gmail.com

2. **تفعيل التحقق بخطوتين**
   - اذهب إلى "الأمان" > "التحقق بخطوتين"
   - فعل التحقق بخطوتين إذا لم يكن مفعل

3. **إنشاء كلمة مرور التطبيق**
   - اذهب إلى "الأمان" > "كلمات مرور التطبيقات"
   - اختر "تطبيق آخر" واكتب "Maison Darin Website"
   - انسخ كلمة المرور المُنشأة (16 رقم)

4. **إضافة كلمة المرور للمشروع**
   - افتح ملف `.env` في مجلد الباك إند
   - أضف: `EMAIL_APP_PASSWORD=your-16-digit-password-here`
   - احفظ الملف وأعد تشغيل الخادم

## الملفات المتأثرة

### Backend:
- `config/email.js` - الإعدادات الثابتة
- `services/emailService.js` - خدمة الإيميل المحدثة
- `models/SiteSettings.js` - إزالة حقول SMTP
- `.env.example` - مثال على متغير البيئة

### Frontend:
- `services/siteSettingsService.ts` - واجهة محدثة
- `components/admin/SiteSettingsManager.tsx` - إزالة حقول SMTP
- `hooks/useSiteSettings.ts` - بنية محدثة

## المميزات الأمنية

### ✅ ما تم تأمينه:
- إعدادات SMTP محمية في الكود
- كلمة المرور في متغير البيئة فقط
- لا يمكن تغيير الإعدادات من لوحة التحكم
- حماية من التلاعب بإعدادات الإيميل

### ⚠️ ما يجب مراعاته:
- تأكد من عدم رفع ملف `.env` إلى Git
- غير كلمة مرور التطبيق بانتظام
- راقب سجلات الإيميل للأنشطة المشبوهة

## استكشاف الأخطاء

### مشكلة: فشل إرسال الإيميل
**الحلول:**
1. تأكد من صحة `EMAIL_APP_PASSWORD` في `.env`
2. تأكد من تفعيل التحقق بخطوتين في Gmail
3. تأكد من صحة كلمة مرور التطبيق (16 رقم)
4. أعد تشغيل الخادم بعد تحديث `.env`

### مشكلة: خطأ Authentication
**الحلول:**
1. أنشئ كلمة مرور تطبيق جديدة
2. تأكد من استخدام الحساب الصحيح (maisondarin2025@gmail.com)
3. تحقق من إعدادات الأمان في Gmail

## الاختبار

### اختبار الإيميل من لوحة التحكم:
1. اذهب إلى "إعدادات الموقع" > "البريد الإلكتروني"
2. اضغط على "اختبار الإيميل"
3. يجب أن تصل رسالة تجريبية إلى maisondarin2025@gmail.com

### اختبار نموذج الاتصال:
1. اذهب إلى الموقع الرئيسي
2. املأ نموذج "اتصل بنا"
3. يجب أن تصل رسالة إشعار للمدير ورسالة تأكيد للعميل

## الدعم
في حالة وجود مشاكل، تأكد من:
- صحة إعدادات Gmail
- تحديث متغيرات البيئة
- إعادة تشغيل الخادم
- مراجعة سجلات الأخطاء
